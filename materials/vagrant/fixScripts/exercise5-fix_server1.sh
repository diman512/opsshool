#!/bin/bash

# 'Generate' private key
echo "-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
" > /home/vagrant/.ssh/id_rsa

# 'Generate' prublic key
echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCevhMllzwAsM9ft8o13Y2Q5rVU7bc8n9QFSXb2F0M+JDGK8gJrE2B3qImnlJh+KoqIRaxPGr7j4QsHETOfhukBDYBQvGLKpWdE3sdN+8y+tMPGtL4FlL8fKRJjeYoJGQJdVNOc/igxkBf0ddnJnGtN/pyXFlXVPaaJgwWbJHJaAECGwe8lyfNBU8Lt6aiPoT1lL8VdGOwzInI7veplEqsJ7+jU5vEjeFQiLmKKIUOIHTT5udSgFbkgmHhVluo7mGj2o0PghPX5aA6bNecUJYqckhiCCFA9nybB/g9TOXG49gBcu4QRf0avA1e2OSqc+vZZQKkuYlgVUv1rFbKvI/LpGw7IPgColActO/WZ+Kny1VEq9dW8u/RGEKCU15HVgHWaiDebL6NHwxZY/gr4EI5/FySoJoY013ASuAbyCjtuU1C0itzgnS3eK0MykxCExVCA+ANvhRzqJr81aLbjhgRf3C1EjKs4Vrc+uhJFR95N/3Ch0Ji8X5O7lfgJHuvZVzP/xoiN6tDk/kigXGnK8zhwzgAZiFDxyOjuLU5VbIdrHqiICpSeEMWvEeOHeHCHJo7QO4MDbsZGxJcczdjz0wlFXIrObMWtYOKO3W/LPNb5h1Eys8mjlnIZWTX3c3oC5AqGkaLOvXZpCTiJsataehJqbqlZkNAvuDz8MGKsxpoetw== vagrant@server1" > /home/vagrant/.ssh/id_rsa.pub


# add public key to authorized_keys
cat /home/vagrant/.ssh/id_rsa.pub >> /home/vagrant/.ssh/authorized_keys


# fix the no ssh key check
cat > /home/vagrant/.ssh/config << EOF
Host *
  StrictHostKeyChecking no
  UserKnownHostsFile=/dev/null
EOF

# Fix Owners and permissions "600 for ssh to work" (since it runs as a sudo)
chown vagrant:vagrant /home/vagrant/.ssh/id_rsa
chown vagrant:vagrant /home/vagrant/.ssh/id_rsa.pub
chown vagrant:vagrant /home/vagrant/.ssh/config
chmod 600 /home/vagrant/.ssh/id_rsa
